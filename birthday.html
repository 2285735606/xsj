<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>ğŸ‰ ç”Ÿæ—¥å¿«ä¹ ğŸ’«</title>
    <style>
        /* åŸºç¡€æ ·å¼ */
        body {
            background: #000;
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: 'Microsoft YaHei', 'SimHei', Arial, sans-serif;
        }

        canvas {
            cursor: crosshair;
            display: block;
            width: 100vw;
            height: 100vh;
        }

        /* åŠ è½½æç¤º */
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #000428, #004e92);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #fff;
            font-size: 24px;
            z-index: 999;
            transition: opacity 1s ease-out;
        }

        .loading.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
<div class="loading" id="loading">
    <div class="spinner"></div>
    <div>ğŸ‰ çƒŸèŠ±å³å°†ç»½æ”¾ ğŸ‰</div>
</div>
<canvas id="canvas"></canvas>

<script>
    // é¡µé¢åŠ è½½å®Œæˆåéšè—åŠ è½½æç¤º
    window.addEventListener('load', function() {
        setTimeout(function() {
            document.getElementById('loading').classList.add('hidden');
        }, 1500);
    });

    // requestAnimationFrame å…¼å®¹æ€§å¤„ç†
    window.requestAnimFrame = (function() {
        return window.requestAnimationFrame ||
            window.webkitRequestAnimationFrame ||
            window.mozRequestAnimationFrame ||
            function(callback) {
                window.setTimeout(callback, 1000 / 60);
            };
    })();

    // åŸºæœ¬å˜é‡è®¾ç½®
    var canvas = document.getElementById('canvas'),
        ctx = canvas.getContext('2d'),
        cw = window.innerWidth,
        ch = window.innerHeight,
        fireworks = [],
        particles = [],
        hue = 120,
        limiterTotal = 3,  // å‡å°‘é™åˆ¶å™¨æ—¶é—´ï¼Œå¢åŠ çƒŸèŠ±å¯†åº¦
        limiterTick = 0,
        timerTotal = 30,   // å‡å°‘è‡ªåŠ¨å‘å°„é—´éš”ï¼Œå¢åŠ çƒŸèŠ±é¢‘ç‡
        timerTick = 0,
        mousedown = false,
        mx,
        my;

    // è®¾ç½®ç”»å¸ƒå°ºå¯¸
    function setCanvasSize() {
        cw = window.innerWidth;
        ch = window.innerHeight;
        canvas.width = cw;
        canvas.height = ch;
    }

    setCanvasSize();
    window.addEventListener('resize', setCanvasSize);

    // å·¥å…·å‡½æ•°
    function random(min, max) {
        return Math.random() * (max - min) + min;
    }

    function calculateDistance(p1x, p1y, p2x, p2y) {
        var xDistance = p1x - p2x,
            yDistance = p1y - p2y;
        return Math.sqrt(Math.pow(xDistance, 2) + Math.pow(yDistance, 2));
    }

    // çƒŸèŠ±ç±»
    function Firework(sx, sy, tx, ty) {
        this.x = sx;
        this.y = sy;
        this.sx = sx;
        this.sy = sy;
        this.tx = tx;
        this.ty = ty;
        this.distanceToTarget = calculateDistance(sx, sy, tx, ty);
        this.distanceTraveled = 0;
        this.coordinates = [];
        this.coordinateCount = 5; // å¢åŠ è½¨è¿¹ç‚¹æ•°

        while(this.coordinateCount--) {
            this.coordinates.push([this.x, this.y]);
        }

        this.angle = Math.atan2(ty - sy, tx - sx);
        this.speed = random(2, 5); // éšæœºé€Ÿåº¦
        this.acceleration = 1.05;
        this.brightness = random(50, 70);
        this.targetRadius = 1;
        this.lineWidth = random(1, 3); // éšæœºçº¿å®½
    }

    Firework.prototype.update = function(index) {
        this.coordinates.pop();
        this.coordinates.unshift([this.x, this.y]);

        if(this.targetRadius < 8) {
            this.targetRadius += 0.3;
        } else {
            this.targetRadius = 1;
        }

        this.speed *= this.acceleration;
        var vx = Math.cos(this.angle) * this.speed,
            vy = Math.sin(this.angle) * this.speed;
        this.distanceTraveled = calculateDistance(this.sx, this.sy, this.x + vx, this.y + vy);

        if(this.distanceTraveled >= this.distanceToTarget) {
            createParticles(this.tx, this.ty);
            fireworks.splice(index, 1);
        } else {
            this.x += vx;
            this.y += vy;
        }
    };

    Firework.prototype.draw = function() {
        ctx.beginPath();
        ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
        ctx.lineTo(this.x, this.y);
        ctx.strokeStyle = 'hsl(' + hue + ', 100%, ' + this.brightness + '%)';
        ctx.lineWidth = this.lineWidth;
        ctx.lineCap = 'round';
        ctx.stroke();

        // ç»˜åˆ¶ç›®æ ‡ç‚¹å…‰æ™•æ•ˆæœ
        ctx.beginPath();
        ctx.arc(this.tx, this.ty, this.targetRadius * 2, 0, Math.PI * 2);
        ctx.fillStyle = 'hsla(' + hue + ', 100%, 50%, 0.3)';
        ctx.fill();
    };

    // ç²’å­ç±»
    function Particle(x, y) {
        this.x = x;
        this.y = y;
        this.coordinates = [];
        this.coordinateCount = 8; // å¢åŠ è½¨è¿¹ç‚¹æ•°

        while(this.coordinateCount--) {
            this.coordinates.push([this.x, this.y]);
        }

        this.angle = random(0, Math.PI * 2);
        this.speed = random(1, 15); // å¢åŠ é€Ÿåº¦èŒƒå›´
        this.friction = 0.95;
        this.gravity = random(0.5, 1.5); // éšæœºé‡åŠ›
        this.hue = random(hue - 30, hue + 30); // æ‰©å¤§è‰²ç›¸èŒƒå›´
        this.brightness = random(50, 100); // æé«˜äº®åº¦èŒƒå›´
        this.alpha = 1;
        this.decay = random(0.01, 0.05); // éšæœºè¡°å‡ç‡
        this.size = random(1, 3); // ç²’å­å¤§å°
    }

    Particle.prototype.update = function(index) {
        this.coordinates.pop();
        this.coordinates.unshift([this.x, this.y]);
        this.speed *= this.friction;
        this.x += Math.cos(this.angle) * this.speed;
        this.y += Math.sin(this.angle) * this.speed + this.gravity;
        this.alpha -= this.decay;

        if(this.alpha <= this.decay) {
            particles.splice(index, 1);
        }
    };

    Particle.prototype.draw = function() {
        ctx.beginPath();
        ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
        ctx.lineTo(this.x, this.y);
        ctx.strokeStyle = 'hsla(' + this.hue + ', 100%, ' + this.brightness + '%, ' + this.alpha + ')';
        ctx.lineWidth = this.size;
        ctx.lineCap = 'round';
        ctx.stroke();

        // æ·»åŠ å…‰æ™•æ•ˆæœ
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size * 2, 0, Math.PI * 2);
        ctx.fillStyle = 'hsla(' + this.hue + ', 100%, ' + this.brightness + '%, ' + (this.alpha * 0.3) + ')';
        ctx.fill();
    };

    // åˆ›å»ºç²’å­
    function createParticles(x, y) {
        // å¤§é‡ç²’å­åˆ›é€ ç»šçƒ‚æ•ˆæœ
        var particleCount = Math.floor(random(50, 100));
        while(particleCount--) {
            particles.push(new Particle(x, y));
        }
    }

    // ç»˜åˆ¶ç²‰è‰²æ–‡å­—
    function drawText() {
        // ä¸»æ ‡é¢˜
        var mainText = "ğŸ‰ ç”Ÿæ—¥å¿«ä¹ ğŸ‰";
        var fontSize = Math.min(cw * 0.1, 80); // æ›´å¤§çš„å­—ä½“
        ctx.font = "bold " + fontSize + "px 'Microsoft YaHei', 'SimHei', Arial, sans-serif";
        ctx.textAlign = "center";
        ctx.textBaseline = "middle";

        // ç²‰è‰²æ¸å˜æ•ˆæœï¼Œé¿å…è¿‡äºåˆºçœ¼
        var pinkGradient = ctx.createLinearGradient(0, ch/2 - fontSize, 0, ch/2 + fontSize);
        pinkGradient.addColorStop(0, "rgba(255, 182, 193, 0.9)");     // æµ…ç²‰è‰²
        pinkGradient.addColorStop(0.5, "rgba(255, 105, 180, 1)");     // æ ‡å‡†ç²‰è‰²
        pinkGradient.addColorStop(1, "rgba(255, 20, 147, 0.9)");      // æ·±ç²‰è‰²

        // æ·»åŠ æŸ”å’Œçš„é˜´å½±æ•ˆæœ
        ctx.shadowColor = "rgba(255, 105, 180, 0.6)";
        ctx.shadowBlur = 15;
        ctx.shadowOffsetX = 0;
        ctx.shadowOffsetY = 0;

        ctx.fillStyle = pinkGradient;
        ctx.fillText(mainText, cw / 2, ch / 3);

        // å‰¯æ ‡é¢˜
        var subText = "æ„¿ä½ å…‰èŠ’ä¸‡ä¸ˆ âœ¨";
        var subFontSize = Math.min(cw * 0.06, 50);
        ctx.font = "bold " + subFontSize + "px 'Microsoft YaHei', 'SimHei', Arial, sans-serif";
        
        // å‰¯æ ‡é¢˜ä¹Ÿä½¿ç”¨ç²‰è‰²ç³»ï¼Œä½†ç¨æµ…ä¸€äº›
        var subPinkGradient = ctx.createLinearGradient(0, ch/2, 0, ch/2 + subFontSize);
        subPinkGradient.addColorStop(0, "rgba(255, 192, 203, 0.9)");
        subPinkGradient.addColorStop(1, "rgba(255, 182, 193, 0.8)");
        
        ctx.fillStyle = subPinkGradient;
        ctx.shadowBlur = 10;
        ctx.fillText(subText, cw / 2, ch / 3 + fontSize + 20);

        // æ¢å¤é»˜è®¤é˜´å½±
        ctx.shadowBlur = 0;
    }

    // ä¸»å¾ªç¯
    function loop() {
        requestAnimFrame(loop);

        // è‰²ç›¸å˜åŒ–åˆ›é€ å½©è™¹æ•ˆæœ
        hue = (hue + 0.8) % 360;

        // åˆ›å»ºæ‹–å°¾æ•ˆæœ
        ctx.globalCompositeOperation = 'destination-out';
        ctx.fillStyle = 'rgba(0, 0, 0, 0.2)'; // å‡å°‘æ‹–å°¾é€æ˜åº¦ï¼Œä¿æŒæ›´å¤šæ®‹å½±
        ctx.fillRect(0, 0, cw, ch);
        ctx.globalCompositeOperation = 'lighter';

        // ç»˜åˆ¶ç²‰è‰²æ–‡å­—
        drawText();

        // æ›´æ–°å’Œç»˜åˆ¶çƒŸèŠ±
        var i = fireworks.length;
        while(i--) {
            fireworks[i].draw();
            fireworks[i].update(i);
        }

        // æ›´æ–°å’Œç»˜åˆ¶ç²’å­
        var j = particles.length;
        while(j--) {
            particles[j].draw();
            particles[j].update(j);
        }

        // è‡ªåŠ¨å‘å°„çƒŸèŠ±
        if(timerTick >= timerTotal) {
            if(!mousedown) {
                // åœ¨å±å¹•ä¸åŒåŒºåŸŸå‘å°„å¤šæŸçƒŸèŠ±
                var fireworkCount = Math.floor(random(3, 8));
                for(var h = 0; h < fireworkCount; h++) {
                    // éšæœºé€‰æ‹©å‘å°„èµ·ç‚¹
                    var startX = random(cw * 0.2, cw * 0.8);
                    var startY = ch;
                    // éšæœºé€‰æ‹©çˆ†ç‚¸ç‚¹
                    var targetX = random(0, cw);
                    var targetY = random(0, ch * 0.7);
                    fireworks.push(new Firework(startX, startY, targetX, targetY));
                }
                timerTick = 0;
            }
        } else {
            timerTick++;
        }

        // é¼ æ ‡/è§¦æ‘¸äº‹ä»¶å‘å°„çƒŸèŠ±
        if(limiterTick >= limiterTotal) {
            if(mousedown) {
                fireworks.push(new Firework(cw / 2, ch, mx, my));
                limiterTick = 0;
            }
        } else {
            limiterTick++;
        }
    }

    // äº‹ä»¶ç›‘å¬ - é¼ æ ‡
    canvas.addEventListener('mousemove', function(e) {
        e.preventDefault();
        mx = e.pageX - canvas.offsetLeft;
        my = e.pageY - canvas.offsetTop;
    });

    canvas.addEventListener('mousedown', function(e) {
        e.preventDefault();
        mousedown = true;
    });

    canvas.addEventListener('mouseup', function(e) {
        e.preventDefault();
        mousedown = false;
    });

    // äº‹ä»¶ç›‘å¬ - è§¦æ‘¸è®¾å¤‡
    canvas.addEventListener('touchstart', function(e) {
        e.preventDefault();
        var touch = e.touches[0];
        mx = touch.clientX - canvas.offsetLeft;
        my = touch.clientY - canvas.offsetTop;
        mousedown = true;
    });

    canvas.addEventListener('touchmove', function(e) {
        e.preventDefault();
        var touch = e.touches[0];
        mx = touch.clientX - canvas.offsetLeft;
        my = touch.clientY - canvas.offsetTop;
    });

    canvas.addEventListener('touchend', function(e) {
        e.preventDefault();
        mousedown = false;
    });

    // å¯åŠ¨åŠ¨ç”»
    window.onload = function() {
        loop();
    };
</script>
</body>
</html>
